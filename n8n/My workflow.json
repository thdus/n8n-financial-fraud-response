{
  "name": "My workflow",
  "nodes": [
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Ifc8H9MEUJJQGZ1pHwz1kD1ebALsa51jQaJsEpP83A4",
          "mode": "list",
          "cachedResultName": "n8n_rule",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ifc8H9MEUJJQGZ1pHwz1kD1ebALsa51jQaJsEpP83A4/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1810420859,
          "mode": "list",
          "cachedResultName": "User_Risk_Status",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ifc8H9MEUJJQGZ1pHwz1kD1ebALsa51jQaJsEpP83A4/edit#gid=1810420859"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "User_ID",
              "lookupValue": "={{ $('Webhook').first().json.body.user_id }}"
            }
          ]
        },
        "options": {
          "returnFirstMatch": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -2544,
        48
      ],
      "id": "33680d5b-a9b6-47f7-9982-bd6816285b09",
      "name": "user_risk_statement",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "V2rzgCtBLjJw9GB5",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.Risk_Level }}",
                    "rightValue": "HIGH",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "6378876f-ec09-4d63-918a-12fc52512442"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "HIGH"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "8f9cebaa-0191-4a4e-bcfb-02111585310c",
                    "leftValue": "={{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.Risk_Level }}",
                    "rightValue": "MEDIUM",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "MEDIUM"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "7a303b6f-9d6c-4290-affd-2a77188b6eac",
                    "leftValue": "={{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.Risk_Level }}",
                    "rightValue": "LOW",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "LOW"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        -1600,
        -64
      ],
      "id": "c32c5cd4-06fe-44fe-8619-134ebef7f915",
      "name": "ìœ„í—˜ë„ ë¶„ë¥˜",
      "executeOnce": true
    },
    {
      "parameters": {
        "jsCode": "// 1ï¸âƒ£ Mergeëœ ì…ë ¥ ë°ì´í„° ìˆ˜ì§‘\nconst mergedData = $input.first().json;\n\n// rule_setì€ ë³„ë„ë¡œ ê°€ì ¸ì˜¤ê¸°\nconst ruleSet = $(\"rule_set\").all().map(item => item.json);\n\n// 2ï¸âƒ£ userState ì¶”ì¶œ\nconst userState = {\n  User_ID: mergedData.User_ID,\n  Current_Total_Score: mergedData.Current_Total_Score || 0,\n  Last_Update_Time: mergedData.Last_Update_Time,\n  Triggered_Rules: mergedData.Triggered_Rules || \"\",\n  Risk_Level: mergedData.Risk_Level\n};\n\n// 3ï¸âƒ£ tx_count ì¶”ì¶œ\nconst txCount = Number(mergedData.tx_count || 0);\n\n// 4ï¸âƒ£ Webhook ë°ì´í„° - Switchë‚˜ transferì—ì„œ ê°€ì ¸ì™€ì•¼ í•¨\n// Mergeì— Webhook ë°ì´í„°ê°€ ì—†ìœ¼ë¯€ë¡œ ì§ì ‘ ì°¸ì¡°\nlet logData;\ntry {\n  logData = $(\"Switch\").first().json;\n} catch (e) {\n  // Switchê°€ ì—†ìœ¼ë©´ Webhook ì§ì ‘ ì°¸ì¡°\n  logData = $(\"Webhook\").first().json.body;\n}\n\n// 5ï¸âƒ£ ì´ˆê¸° ìƒíƒœ\nlet totalScore = Number(userState.Current_Total_Score || 0);\nlet triggeredRules = [];\nif (userState.Triggered_Rules) {\n  triggeredRules.push(userState.Triggered_Rules);\n}\n\n// 6ï¸âƒ£ ë£° í‰ê°€\nruleSet.forEach(rule => {\n  if (!rule.Is_Active) return;\n  let actualValue;\n  \n  if (rule.Target_Field === \"tx_count\") {\n    actualValue = Number(txCount);\n  } else {\n    actualValue = logData[rule.Target_Field];\n  }\n  \n  if (actualValue === undefined || actualValue === null) return;\n  \n  let matched = false;\n  switch (rule.Operator) {\n    case \"!=\":\n      matched = actualValue != rule.Threshold;\n      break;\n    case \">\":\n      matched = Number(actualValue) > Number(rule.Threshold);\n      break;\n    case \">=\":\n      const todayAvg = Number(logData.avgAmount || 0);\n      \n      matched = Number(actualValue) >= todayAvg + Number(rule.Threshold);\n      break;\n    case \"between\":\n      const [min, max] = JSON.parse(\n        rule.Threshold.replace(/'/g, '\"')\n      );\n      matched =\n        Number(actualValue) >= Number(min) &&\n        Number(actualValue) <= Number(max);\n      break;\n    default:\n      matched = false;\n  }\n  \n  if (matched) {\n    totalScore += Number(rule.Score);\n    triggeredRules.push(rule.Rule_Name);\n  }\n});\n\n// 7ï¸âƒ£ ìœ„í—˜ë„ ì‚°ì •\nlet riskLevel = \"LOW\";\nif (totalScore >= 70) {\n  riskLevel = \"HIGH\";\n} else if (totalScore >= 40) {\n  riskLevel = \"MEDIUM\";\n} else if (totalScore > 0) {\n  riskLevel = \"LOW\";\n}\n\n// 8ï¸âƒ£ í˜„ì¬ ì‹œê°„ ìƒì„±\nconst currentTime = new Date().toISOString();\n\n// 9ï¸âƒ£ ìµœì¢… ê²°ê³¼ - ë¹„ì–´ìˆìœ¼ë©´ ìƒˆ ê°’ìœ¼ë¡œ ì´ˆê¸°í™”\nconst updatedUserRiskStatement = {\n  ...userState,\n  User_ID: userState.User_ID,\n  Current_Total_Score: totalScore,\n  Last_Update_Time: logData.ts || currentTime, // ë¹„ì–´ìˆìœ¼ë©´ í˜„ì¬ ì‹œê°„\n  Triggered_Rules: triggeredRules.filter(Boolean).join(\", \") || \"\", // ë¹„ì–´ìˆìœ¼ë©´ ë¹ˆ ë¬¸ìì—´\n  Risk_Level: riskLevel,\n  Category: logData.event_type || \"UNKNOWN\"\n};\n\nreturn [{ json: updatedUserRiskStatement }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1792,
        -48
      ],
      "id": "b5e970e7-8610-47a9-b537-a62161790f9d",
      "name": "ìœ„í—˜ë„ ê³„ì‚°",
      "executeOnce": false
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Ifc8H9MEUJJQGZ1pHwz1kD1ebALsa51jQaJsEpP83A4",
          "mode": "list",
          "cachedResultName": "n8n_rule",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ifc8H9MEUJJQGZ1pHwz1kD1ebALsa51jQaJsEpP83A4/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1810420859,
          "mode": "list",
          "cachedResultName": "User_Risk_Status",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ifc8H9MEUJJQGZ1pHwz1kD1ebALsa51jQaJsEpP83A4/edit#gid=1810420859"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "User_ID": "={{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.User_ID }}",
            "Current_Total_Score": "=0",
            "Last_Update_Time": "={{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.Last_Update_Time }}",
            "Triggered_Rules": "="
          },
          "matchingColumns": [
            "User_ID"
          ],
          "schema": [
            {
              "id": "User_ID",
              "displayName": "User_ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Current_Total_Score",
              "displayName": "Current_Total_Score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Last_Update_Time",
              "displayName": "Last_Update_Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Triggered_Rules",
              "displayName": "Triggered_Rules",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "blocked",
              "displayName": "blocked",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -496,
        64
      ],
      "id": "7246d6af-b0fc-4912-be13-bcb32ffe0d7c",
      "name": "user_risk_reset",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "V2rzgCtBLjJw9GB5",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1Ifc8H9MEUJJQGZ1pHwz1kD1ebALsa51jQaJsEpP83A4",
          "mode": "list",
          "cachedResultName": "n8n_rule",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ifc8H9MEUJJQGZ1pHwz1kD1ebALsa51jQaJsEpP83A4/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1810420859,
          "mode": "list",
          "cachedResultName": "User_Risk_Status",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ifc8H9MEUJJQGZ1pHwz1kD1ebALsa51jQaJsEpP83A4/edit#gid=1810420859"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "User_ID": "={{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.User_ID }}",
            "Current_Total_Score": "={{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.Current_Total_Score }}",
            "Last_Update_Time": "={{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.Last_Update_Time }}",
            "Triggered_Rules": "={{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.Triggered_Rules }}"
          },
          "matchingColumns": [
            "User_ID"
          ],
          "schema": [
            {
              "id": "User_ID",
              "displayName": "User_ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Current_Total_Score",
              "displayName": "Current_Total_Score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Last_Update_Time",
              "displayName": "Last_Update_Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Triggered_Rules",
              "displayName": "Triggered_Rules",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "blocked",
              "displayName": "blocked",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -1264,
        16
      ],
      "id": "25e9a426-61fc-4f5d-88ed-cbf0101dbd47",
      "name": "user_risk_update",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "V2rzgCtBLjJw9GB5",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "760fe8a5-41f2-4728-8998-4d85d78441c0",
              "name": "tx_count",
              "value": "={{ Number($json.tx_count || 0) }}",
              "type": "number"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2304,
        -304
      ],
      "id": "97845557-1d06-4390-b8c7-b55d9aa3fb0e",
      "name": "get_tx_count"
    },
    {
      "parameters": {
        "operation": "delete",
        "key": "=tx_count:{{ $json.User_ID }}"
      },
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -352,
        64
      ],
      "id": "00c2e555-6e4e-4582-ad84-7b0f1038ff68",
      "name": "tx_count ì´ˆê¸°í™”",
      "credentials": {
        "redis": {
          "id": "tuo5rglQup2fbC4o",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1Ifc8H9MEUJJQGZ1pHwz1kD1ebALsa51jQaJsEpP83A4",
          "mode": "list",
          "cachedResultName": "n8n_rule",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ifc8H9MEUJJQGZ1pHwz1kD1ebALsa51jQaJsEpP83A4/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Rule_Set",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Ifc8H9MEUJJQGZ1pHwz1kD1ebALsa51jQaJsEpP83A4/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Category",
              "lookupValue": "={{ $('Webhook').first().json.body.event_type }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -2544,
        -128
      ],
      "id": "e70cbdc4-fcaa-4993-852a-d414b01da9d3",
      "name": "rule_set",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "V2rzgCtBLjJw9GB5",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ë‹¤ìŒì€ FDS ì‹œìŠ¤í…œì—ì„œ ê°ì§€ëœ ì‚¬ìš©ì í™œë™ ì •ë³´ì…ë‹ˆë‹¤.\n\n[ê°ì§€ ì •ë³´]\n- ì‚¬ìš©ì ID: {{ $json.User_ID }}\n- ìœ„í—˜ë„ ìˆ˜ì¤€: {{ $json.Risk_Level }}\n- ìœ„í—˜ ì ìˆ˜: {{ $json.Current_Total_Score }}\n- íŠ¸ë¦¬ê±°ëœ ê·œì¹™: {{ $json.Triggered_Rules }}\n- ì´ë²¤íŠ¸ ìœ í˜•: {{ $json.Category }}\n- ê°ì§€ ì‹œê°: {{ $json.Last_Update_Time }}\n\në‹¹ì‹ ì€ FDS ê´€ë¦¬ìì—ê²Œ ë³´ì•ˆ ì´ìŠˆë¥¼ ë³´ê³ í•˜ëŠ” ì—­í• ì´ë‹¤.\nì•„ë˜ ì§€ì¹¨ì„ ì§€ì¼œ ê´€ë¦¬ììš© ì•Œë¦¼ ë©”ì‹œì§€ë¥¼ ì‘ì„±í•˜ë¼.\n\n1ï¸âƒ£ [ìƒí™© ìš”ì•½]\n- ì–´ë–¤ ì‚¬ìš©ìê°€ ì–´ë–¤ ë¹„ì •ìƒ í–‰ë™ì„ í–ˆëŠ”ì§€ ëª…í™•í•˜ê²Œ 2~3ë¬¸ì¥ìœ¼ë¡œ ìš”ì•½\n- \"ì•¼ê°„ ë¡œê·¸ì¸ ì‹œë„\", \"ë‹¨ì‹œê°„ ë‚´ ë‹¤ìˆ˜ ê±°ë˜\" ë“± êµ¬ì²´ì ì¸ íŒ¨í„´ ì–¸ê¸‰\n\n2ï¸âƒ£ [ìœ„í—˜ ë¶„ì„]\n- í•´ë‹¹ í–‰ë™ì´ ì™œ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ì§€, ì–´ë–¤ ê·œì¹™ì— ê±¸ë ¸ëŠ”ì§€ ì„¤ëª…\n- ë¶ˆë¦¿ í¬ì¸íŠ¸ 2~3ê°œë¡œ í•µì‹¬ë§Œ ì •ë¦¬\n\n3ï¸âƒ£ [ì¡°ì¹˜ ì‚¬í•­]\n- ì‹œìŠ¤í…œì´ ì·¨í•œ ìë™ ì¡°ì¹˜ (ê³„ì • ì°¨ë‹¨, ì¶”ê°€ ì¸ì¦ ìš”êµ¬ ë“±)\n- ê´€ë¦¬ìê°€ ì¶”ê°€ë¡œ í™•ì¸í•´ì•¼ í•  ì‚¬í•­\n\n4ï¸âƒ£ [ë¬¸ì²´]\n- ê°„ê²°í•˜ê³  íŒ©íŠ¸ ì¤‘ì‹¬ì˜ ë³´ê³  í˜•ì‹\n- ì „ë¬¸ ìš©ì–´ ì‚¬ìš© ê°€ëŠ¥\n- ë§ˆí¬ë‹¤ìš´ í˜•ì‹(**êµµê²Œ**, â€¢ ë¶ˆë¦¿) ì‚¬ìš© ê°€ëŠ¥\n- 300ì ì´ë‚´\n\nì¶œë ¥ì€ í•œêµ­ì–´ë¡œ ì‘ì„±í•˜ë¼.",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        -1056,
        -240
      ],
      "id": "ef4358b5-b6ab-4501-ba41-d661620e4120",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "operation": "get",
        "propertyName": "tx_count",
        "key": "=tx_count:{{ $('Webhook').first().json.body.user_id }}",
        "options": {}
      },
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -2544,
        -288
      ],
      "id": "551865d7-4a98-4a9b-8b1f-4bc316b26902",
      "name": "transfer_íšŸìˆ˜_ì¡°íšŒ",
      "credentials": {
        "redis": {
          "id": "tuo5rglQup2fbC4o",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "claude-sonnet-4-5-20250929",
          "cachedResultName": "Claude Sonnet 4.5"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        -1056,
        -96
      ],
      "id": "19dc3f2f-8678-45af-a71b-11fcb4918b74",
      "name": "Anthropic Chat Model",
      "credentials": {
        "anthropicApi": {
          "id": "mgbo2KVIqQmglTHs",
          "name": "Anthropic account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "dd866d46-8a0b-4dfc-b853-55d3179511fd",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -2960,
        0
      ],
      "id": "c416daf5-516c-4f25-82eb-a48d5c289cd4",
      "name": "Webhook",
      "webhookId": "dd866d46-8a0b-4dfc-b853-55d3179511fd"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C0AA8FUFMUG",
          "mode": "list",
          "cachedResultName": "n8n"
        },
        "text": "={{ $('AI Agent').item.json.output }}\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nğŸ“Š ìƒì„¸ ì •ë³´\n- ì‚¬ìš©ì: {{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.User_ID }}\n- ìœ„í—˜ë„: {{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.Risk_Level }}\n- ì ìˆ˜: {{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.Current_Total_Score }}ì \n- ê°ì§€ ì‹œê°: {{ $('ìœ„í—˜ë„ ê³„ì‚°').item.json.Last_Update_Time }}\n<https://db8b999754d843eaa085e367de908dd8.us-central1.gcp.cloud.es.io/app/dashboards#/view/c1e254c6-1c6c-4522-b627-16b68c145c92?_g=(filters:!(),refreshInterval:(pause:!t,value:60000),time:(from:now-7d%2Fd,to:now))|ğŸ“Š ëŒ€ì‹œë³´ë“œ ë°”ë¡œê°€ê¸°>",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.4,
      "position": [
        -672,
        64
      ],
      "id": "8d8f4a3f-f352-4b2c-9e86-0ed08addc058",
      "name": "ê´€ë¦¬ì ì•Œë¦¼",
      "webhookId": "7dfce69f-e0e9-47c2-af2c-0789de1a4af0",
      "credentials": {
        "slackApi": {
          "id": "pwz3kwSMVzyXxncG",
          "name": "Slack account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://host.docker.internal:8080/user/update-risk",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "user_id",
              "value": "={{ $json.User_ID }}"
            },
            {
              "name": "risk_level",
              "value": "HIGH"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -1488,
        -592
      ],
      "id": "d253fa7d-738e-4e52-aac5-cff0a4f63608",
      "name": "risk_level_HIGH"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://host.docker.internal:8080/user/update-risk",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "user_id",
              "value": "=={{ $json.User_ID }}"
            },
            {
              "name": "risk_level",
              "value": "MEDIUM"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -1344,
        368
      ],
      "id": "930bc425-1ec6-4ea3-bea5-c87ebb06c412",
      "name": "risk_level_MEDIUM"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "numberInputs": 4,
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -2016,
        -64
      ],
      "id": "68e6439b-683e-4b6e-839d-a976b17f952c",
      "name": "Merge",
      "alwaysOutputData": true
    }
  ],
  "pinData": {},
  "connections": {
    "user_risk_statement": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "ìœ„í—˜ë„ ê³„ì‚°": {
      "main": [
        [
          {
            "node": "ìœ„í—˜ë„ ë¶„ë¥˜",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ìœ„í—˜ë„ ë¶„ë¥˜": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          },
          {
            "node": "risk_level_HIGH",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "risk_level_MEDIUM",
            "type": "main",
            "index": 0
          },
          {
            "node": "user_risk_update",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "user_risk_update",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "user_risk_update": {
      "main": [
        []
      ]
    },
    "user_risk_reset": {
      "main": [
        [
          {
            "node": "tx_count ì´ˆê¸°í™”",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get_tx_count": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rule_set": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "ê´€ë¦¬ì ì•Œë¦¼",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "transfer_íšŸìˆ˜_ì¡°íšŒ": {
      "main": [
        [
          {
            "node": "get_tx_count",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 3
          },
          {
            "node": "transfer_íšŸìˆ˜_ì¡°íšŒ",
            "type": "main",
            "index": 0
          },
          {
            "node": "rule_set",
            "type": "main",
            "index": 0
          },
          {
            "node": "user_risk_statement",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ê´€ë¦¬ì ì•Œë¦¼": {
      "main": [
        [
          {
            "node": "user_risk_reset",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "risk_level_HIGH": {
      "main": [
        []
      ]
    },
    "risk_level_MEDIUM": {
      "main": [
        []
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "ìœ„í—˜ë„ ê³„ì‚°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "tx_count ì´ˆê¸°í™”": {
      "main": [
        []
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "ba7458b9-3917-42a7-ae76-9e68d024405e",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "da7812da65f7a890c5cedea61c1efa5ae6ac84c7d3b7029d4d004acb742e1328"
  },
  "id": "dr6Qns5P_sfBousm_pdI6",
  "tags": []
}